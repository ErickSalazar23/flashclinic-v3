(()=>{var e={};e.id=105,e.ids=[105],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},6290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d});var a=s(260),r=s(8203),n=s(5155),o=s.n(n),l=s(7292),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);s.d(t,i);let d=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7154)),"C:\\Users\\USER\\Proyectos Personales Software\\v3-saas-factory\\saas-factory-setup\\saas-factory\\src\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1354)),"C:\\Users\\USER\\Proyectos Personales Software\\v3-saas-factory\\saas-factory-setup\\saas-factory\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,1485,23)),"next/dist/client/components/unauthorized-error"]}],c=["C:\\Users\\USER\\Proyectos Personales Software\\v3-saas-factory\\saas-factory-setup\\saas-factory\\src\\app\\dashboard\\page.tsx"],x={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4156:(e,t,s)=>{"use strict";s.r(t),s.d(t,{"00a10976f04beef674dbe7fa8a6b100c903bcdffa6":()=>a.o});var a=s(3606)},2244:(e,t,s)=>{Promise.resolve().then(s.bind(s,5122))},4591:(e,t,s)=>{Promise.resolve().then(s.bind(s,1606))},1606:(e,t,s)=>{"use strict";s.d(t,{OperationalDashboard:()=>l});var a=s(5512),r=s(8531),n=s.n(r);function o(e){return new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e)}function l({metrics:e}){return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-[#0a1628] to-slate-950 text-white p-6",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-12 flex items-center justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-2xl",children:"\uD83D\uDDFC"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-black bg-gradient-to-r from-cyan-400 via-blue-400 to-violet-400 bg-clip-text text-transparent",children:"Torre de Control"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Motor Operacional - Estado en Vivo"})]})]})}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Flash Clinic V3"}),(0,a.jsx)("p",{className:"text-green-400 font-mono text-xs",children:"Status: OPERATIVO ✓"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"group bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-red-500/30 rounded-2xl p-6 hover:border-red-500/60 hover:shadow-lg hover:shadow-red-500/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-red-400/70 text-xs font-bold uppercase tracking-widest mb-2",children:"\uD83D\uDC80 Hemorragia Hoy"}),(0,a.jsx)("div",{className:"text-4xl font-black text-red-400",children:o(e.hemorragiaHoy)})]}),(0,a.jsx)("div",{className:"text-3xl opacity-20",children:"\uD83D\uDCC9"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:"P\xe9rdida por cancelaciones/no-shows"}),(0,a.jsx)("div",{className:"mt-3 h-1 bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-red-500/80 transition-all",style:{width:`${Math.min(e.hemorragiaHoy/500*100,100)}%`}})})]}),(0,a.jsxs)("div",{className:"group bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-green-500/30 rounded-2xl p-6 hover:border-green-500/60 hover:shadow-lg hover:shadow-green-500/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-400/70 text-xs font-bold uppercase tracking-widest mb-2",children:"✨ Dinero Recuperado"}),(0,a.jsx)("div",{className:"text-4xl font-black text-green-400",children:o(e.dineroRecuperado)})]}),(0,a.jsx)("div",{className:"text-3xl opacity-20",children:"\uD83D\uDCC8"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:"Por citas confirmadas hoy"}),(0,a.jsx)("div",{className:"mt-3 h-1 bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-green-500/80 transition-all",style:{width:`${Math.min(e.dineroRecuperado/500*100,100)}%`}})})]}),(0,a.jsxs)("div",{className:"group bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-orange-500/30 rounded-2xl p-6 hover:border-orange-500/60 hover:shadow-lg hover:shadow-orange-500/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-orange-400/70 text-xs font-bold uppercase tracking-widest mb-2",children:"⚠️ Citas en Riesgo"}),(0,a.jsx)("div",{className:"text-4xl font-black text-orange-400",children:e.citasEnRiesgo})]}),(0,a.jsx)("div",{className:"text-3xl opacity-20",children:"\uD83C\uDFAF"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:"Pendientes confirmaci\xf3n (24h)"}),(0,a.jsx)("div",{className:"mt-3 h-1 bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-orange-500/80 transition-all",style:{width:`${Math.min(e.citasEnRiesgo/20*100,100)}%`}})})]}),(0,a.jsxs)("div",{className:"group bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-cyan-500/30 rounded-2xl p-6 hover:border-cyan-500/60 hover:shadow-lg hover:shadow-cyan-500/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-cyan-400/70 text-xs font-bold uppercase tracking-widest mb-2",children:"\uD83D\uDCCA Tasa No-Show"}),(0,a.jsxs)("div",{className:"text-4xl font-black text-cyan-400",children:[e.tasaNoShow,"%"]})]}),(0,a.jsx)("div",{className:"text-3xl opacity-20",children:"\uD83D\uDCC8"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:"Hist\xf3rico vs Benchmark (15-25%)"}),(0,a.jsx)("div",{className:"mt-3 h-1 bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-cyan-500/80 transition-all",style:{width:`${Math.min(e.tasaNoShow/25*100,100)}%`}})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-cyan-500/30 rounded-2xl p-6 hover:border-cyan-500/60 transition-all",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCCA"}),"Resumen de Hoy"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-800/50 rounded-lg",children:[(0,a.jsx)("span",{className:"text-slate-300 font-semibold",children:"Total de Citas"}),(0,a.jsx)("span",{className:"text-2xl font-black text-cyan-400",children:e.citasHoy})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-800/50 rounded-lg",children:[(0,a.jsx)("span",{className:"text-slate-300 font-semibold",children:"✅ Confirmadas"}),(0,a.jsx)("span",{className:"text-2xl font-black text-green-400",children:e.citasConfirmadas})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-800/50 rounded-lg",children:[(0,a.jsx)("span",{className:"text-slate-300 font-semibold",children:"⏳ Pendientes"}),(0,a.jsx)("span",{className:"text-2xl font-black text-orange-400",children:e.citasPendientesConfirmacion})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-slate-800/50 rounded-lg",children:[(0,a.jsx)("span",{className:"text-slate-300 font-semibold",children:"❌ Canceladas"}),(0,a.jsx)("span",{className:"text-2xl font-black text-red-400",children:e.citasCanceladas})]})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-red-500/30 rounded-2xl p-6 hover:border-red-500/60 transition-all",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCB0"}),"Impacto Financiero"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-400 text-xs uppercase tracking-widest mb-2",children:"P\xe9rdida Este Mes"}),(0,a.jsx)("p",{className:"text-3xl font-black text-red-400",children:o(e.hemorragiaMes)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-400 text-xs uppercase tracking-widest mb-2",children:"Dinero en Riesgo (Hoy)"}),(0,a.jsx)("p",{className:"text-3xl font-black text-orange-400",children:o(e.dineroEnRiesgo)})]}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-green-950/30 border border-green-500/30 rounded-lg",children:[(0,a.jsx)("p",{className:"text-green-400/80 text-xs font-bold uppercase tracking-widest mb-1",children:"Potencial de Recuperaci\xf3n"}),(0,a.jsx)("p",{className:"text-2xl font-black text-green-400",children:o(e.dineroRecuperado)})]})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-violet-500/30 rounded-2xl p-6 hover:border-violet-500/60 transition-all",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD16"}),"Motor Operacional"]}),(0,a.jsx)("div",{className:"space-y-3",children:e.systemActions&&e.systemActions.length>0?e.systemActions.slice(0,4).map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-slate-800/50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-green-400 mt-0.5",children:"✓"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-slate-200 text-xs leading-tight",children:e.description}),(0,a.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:function(e){let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/6e4),a=Math.floor(s/60);return s<1?"hace unos segundos":s<60?`hace ${s} min`:a<24?`hace ${a}h`:t.toLocaleDateString("es-ES")}(e.timestamp)})]})]},e.id)):(0,a.jsxs)("div",{className:"p-4 text-center",children:[(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Sistema en espera de acciones"}),(0,a.jsx)("p",{className:"text-slate-500 text-xs mt-2",children:"(Se mostrar\xe1 actividad en Phase 4)"})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:[(0,a.jsxs)(n(),{href:"/prospects",className:"group p-6 bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-cyan-500/30 rounded-2xl hover:border-cyan-500/60 hover:shadow-lg hover:shadow-cyan-500/20 transition-all",children:[(0,a.jsx)("div",{className:"text-3xl mb-3",children:"\uD83D\uDD0D"}),(0,a.jsx)("h4",{className:"font-bold text-white mb-2",children:"Prospectos"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Gestiona tu pipeline de ventas"})]}),(0,a.jsxs)(n(),{href:"/pendientes",className:"group p-6 bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-orange-500/30 rounded-2xl hover:border-orange-500/60 hover:shadow-lg hover:shadow-orange-500/20 transition-all",children:[(0,a.jsx)("div",{className:"text-3xl mb-3",children:"⚡"}),(0,a.jsx)("h4",{className:"font-bold text-white mb-2",children:"Pendientes"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Decisiones y acciones urgentes"})]}),(0,a.jsxs)(n(),{href:"/landing",className:"group p-6 bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-violet-500/30 rounded-2xl hover:border-violet-500/60 hover:shadow-lg hover:shadow-violet-500/20 transition-all",children:[(0,a.jsx)("div",{className:"text-3xl mb-3",children:"\uD83C\uDFAF"}),(0,a.jsx)("h4",{className:"font-bold text-white mb-2",children:"Calculadora de Fugas"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Diagn\xf3stico de hemorragia financiera"})]})]}),(0,a.jsxs)("div",{className:"p-8 bg-gradient-to-r from-cyan-950/30 via-blue-950/30 to-violet-950/30 border border-cyan-500/30 rounded-2xl text-center",children:[(0,a.jsx)("h4",{className:"text-2xl font-bold text-white mb-3",children:"\uD83E\uDD16 Sistema Aut\xf3nomo"}),(0,a.jsx)("p",{className:"text-slate-300 mb-6 max-w-2xl mx-auto",children:"El motor operacional est\xe1 escaneando citas en tiempo real. Las confirmaciones autom\xe1ticas se enviar\xe1n v\xeda WhatsApp seg\xfan se configuren. (En Phase 4)"}),(0,a.jsx)("button",{className:"px-8 py-3 bg-gradient-to-r from-cyan-500 via-blue-500 to-violet-500 text-white font-bold rounded-lg hover:shadow-xl hover:shadow-cyan-500/50 transition-all transform hover:scale-105",children:"Ver Prescripciones \uD83C\uDFAF"})]})]})})}},3606:(e,t,s)=>{"use strict";s.d(t,{o:()=>n});var a=s(8977);s(8063);var r=s(5546);async function n(){try{let e=(0,r.U)(),{data:{user:t},error:s}=await e.auth.getUser();if(s||!t)return{ok:!1,error:"No autenticado. Por favor inicia sesi\xf3n."};let a=new Date;a.setHours(0,0,0,0);let n=new Date(a);n.setDate(n.getDate()+1);let o=a.toISOString().split("T")[0],l=n.toISOString().split("T")[0],i=new Date;i.setDate(1),i.setHours(0,0,0,0);let{data:d,error:c}=await e.from("appointments").select("id, status, appointment_date").eq("user_id",t.id).eq("appointment_date",o);if(c)throw Error(`Failed to fetch today's appointments: ${c.message}`);let x=d?.length||0,m=d?.filter(e=>"confirmed"===e.status).length||0,h=d?.filter(e=>"cancelled"===e.status).length||0,p=d?.filter(e=>"pending"===e.status).length||0,{data:u,error:g}=await e.from("appointments").select("id, status, appointment_date").eq("user_id",t.id).eq("status","pending").gte("appointment_date",o).lt("appointment_date",l);if(g)throw Error(`Failed to fetch risk appointments: ${g.message}`);let b=u?.length||0,f=new Date(a);f.setDate(f.getDate()-1),f.toISOString().split("T")[0];let{data:v,error:j}=await e.from("appointments").select("id, status").eq("user_id",t.id).lt("appointment_date",o);if(j)throw Error(`Failed to fetch past appointments: ${j.message}`);let N=v?.length||1,w=v?.filter(e=>"no_show"===e.status).length||0,y=N>0?Math.round(w/N*100):0,D=50*(h+d?.filter(e=>"no_show"===e.status).length||0),{data:P,error:C}=await e.from("appointments").select("id, status, appointment_date").eq("user_id",t.id).gte("appointment_date",i.toISOString().split("T")[0]).lt("appointment_date",l);if(C)throw Error(`Failed to fetch month appointments: ${C.message}`);let k=50*(P?.filter(e=>"cancelled"===e.status||"no_show"===e.status).length||0);return{ok:!0,data:{citasHoy:x,citasPendientesConfirmacion:p,citasConfirmadas:m,citasCanceladas:h,citasEnRiesgo:b,tasaNoShow:y,hemorragiaHoy:D,hemorragiaMes:k,dineroRecuperado:50*m,dineroEnRiesgo:50*p,systemActions:[]}}}catch(e){return console.error("Error calculating appointments metrics:",e),{ok:!1,error:e instanceof Error?e.message:"Failed to calculate metrics"}}}(0,s(6215).D)([n]),(0,a.A)(n,"00a10976f04beef674dbe7fa8a6b100c903bcdffa6",null)},7154:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,dynamic:()=>o});var a=s(2740),r=s(3606),n=s(5122);let o="force-dynamic";async function l(){let e=await (0,r.o)();return e.ok?(0,a.jsx)(n.OperationalDashboard,{metrics:e.data}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-[#0a1628] to-slate-950 text-white p-6 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"max-w-md text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-red-400 mb-4",children:"Error"}),(0,a.jsx)("p",{className:"text-slate-300",children:e.error})]})})}},5122:(e,t,s)=>{"use strict";s.d(t,{OperationalDashboard:()=>a});let a=(0,s(6760).registerClientReference)(function(){throw Error("Attempted to call OperationalDashboard() from the server but OperationalDashboard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\USER\\Proyectos Personales Software\\v3-saas-factory\\saas-factory-setup\\saas-factory\\src\\features\\dashboard\\components\\OperationalDashboard.tsx","OperationalDashboard")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[10,403,531,969,125],()=>s(6290));module.exports=a})();