(()=>{var e={};e.id=105,e.ids=[105],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},6290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d});var a=s(260),r=s(8203),n=s(5155),o=s.n(n),i=s(7292),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let d=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7154)),"C:\\Users\\USER\\Proyectos Personales Software\\v3-saas-factory\\saas-factory-setup\\saas-factory\\src\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1354)),"C:\\Users\\USER\\Proyectos Personales Software\\v3-saas-factory\\saas-factory-setup\\saas-factory\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,1485,23)),"next/dist/client/components/unauthorized-error"]}],c=["C:\\Users\\USER\\Proyectos Personales Software\\v3-saas-factory\\saas-factory-setup\\saas-factory\\src\\app\\dashboard\\page.tsx"],x={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4156:(e,t,s)=>{"use strict";s.r(t),s.d(t,{"00a10976f04beef674dbe7fa8a6b100c903bcdffa6":()=>a.o});var a=s(3606)},2244:(e,t,s)=>{Promise.resolve().then(s.bind(s,5122))},4591:(e,t,s)=>{Promise.resolve().then(s.bind(s,4217))},4217:(e,t,s)=>{"use strict";s.d(t,{OperationalDashboard:()=>x});var a=s(5512),r=s(8531),n=s.n(r),o=s(8009),i=s(9334),l=s(3746);function d(){let[e,t]=(0,o.useState)(!1),[s,r]=(0,o.useState)(null),[n,d]=(0,o.useState)(!0),[c,x]=(0,o.useState)(!1),m=(0,o.useRef)(null),h=(0,i.useRouter)(),p=(0,l.U)(),u=async()=>{x(!0);try{await p.auth.signOut(),h.push("/landing")}catch(e){console.error("Error signing out:",e),x(!1)}};return n?(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-700/50 animate-pulse"}):(0,a.jsxs)("div",{ref:m,className:"relative",children:[(0,a.jsx)("button",{onClick:()=>t(!e),className:"w-10 h-10 rounded-full bg-gradient-to-br from-cyan-500/30 to-blue-600/30 hover:from-cyan-500/50 hover:to-blue-600/50 border border-cyan-500/40 hover:border-cyan-500/70 flex items-center justify-center text-sm font-bold text-cyan-400 transition-all duration-300 hover:shadow-lg hover:shadow-cyan-500/20",title:s||"User",children:s?s.split("@")[0].split(".").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?"}),e&&(0,a.jsxs)("div",{className:"absolute right-0 mt-3 w-56 bg-slate-900/95 border border-slate-700/50 rounded-xl shadow-2xl shadow-slate-900/50 overflow-hidden backdrop-blur-xl z-50 animate-in fade-in duration-200",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-slate-700/30",children:[(0,a.jsx)("p",{className:"text-xs text-slate-400 uppercase tracking-widest mb-1",children:"Cuenta"}),(0,a.jsx)("p",{className:"text-sm text-white font-medium truncate",children:s})]}),(0,a.jsxs)("button",{onClick:u,disabled:c,className:"w-full px-4 py-3 text-left text-sm font-semibold text-slate-200 hover:text-white bg-red-950/0 hover:bg-red-950/40 border-t border-slate-700/30 hover:border-red-500/40 transition-all duration-300 flex items-center gap-2 group relative overflow-hidden disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-red-500/0 via-red-500/10 to-red-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,a.jsx)("div",{className:"absolute -inset-1 bg-red-500/20 rounded blur-2xl opacity-0 group-hover:opacity-30 transition-opacity duration-300"}),(0,a.jsx)("span",{className:"relative z-10",children:c?"⏳ Cerrando sesi\xf3n...":"\uD83D\uDEAA Cerrar Sesi\xf3n"})]})]})]})}function c(e){return new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e)}function x({metrics:e}){return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-950 to-slate-950 text-white p-6 relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 opacity-5",children:(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-cyan-500/10 via-transparent to-transparent"})}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-12 flex items-center justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-2xl",children:"\uD83D\uDDFC"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-black bg-gradient-to-r from-cyan-400 via-blue-400 to-violet-400 bg-clip-text text-transparent",children:"Torre de Control"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Motor Operacional - Estado en Vivo"})]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Flash Clinic V3"}),(0,a.jsx)("p",{className:"text-green-400 font-mono text-xs",children:"Status: OPERATIVO ✓"})]}),(0,a.jsx)("div",{className:"h-10 w-px bg-slate-700/50"}),(0,a.jsx)(d,{})]})]}),e.weeklyRecovery&&(0,a.jsx)("div",{className:"mb-8 bg-gradient-to-r from-green-950/40 via-emerald-950/40 to-green-950/40 border-2 border-green-500/50 rounded-3xl p-8 shadow-2xl shadow-green-500/20",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center text-5xl animate-pulse",children:"up"===e.weeklyRecovery.trendDirection?"\uD83D\uDCC8":"✅"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-400/70 text-sm font-bold uppercase tracking-widest mb-2",children:"Sistema Trabajando Para Ti"}),(0,a.jsxs)("h2",{className:"text-5xl font-black text-white mb-2",children:["Esta semana recuperamos"," ",(0,a.jsxs)("span",{className:"bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent",children:[e.weeklyRecovery.citasRecuperadas," citas"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6 mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-400 text-xs uppercase",children:"Ingresos Protegidos"}),(0,a.jsx)("p",{className:"text-3xl font-black text-green-400",children:c(e.weeklyRecovery.dineroRecuperado)})]}),(0,a.jsx)("div",{className:"h-12 w-px bg-slate-700"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-400 text-xs uppercase",children:"vs Semana Pasada"}),(0,a.jsxs)("p",{className:`text-2xl font-black ${e.weeklyRecovery.comparisonVsLastWeek>0?"text-green-400":e.weeklyRecovery.comparisonVsLastWeek<0?"text-red-400":"text-slate-400"}`,children:[e.weeklyRecovery.comparisonVsLastWeek>0?"+":"",e.weeklyRecovery.comparisonVsLastWeek,"%"]})]})]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-slate-400 text-sm mb-2",children:"Sin tu intervenci\xf3n"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-400",children:[(0,a.jsx)("span",{className:"text-4xl",children:"\uD83E\uDD16"}),(0,a.jsx)("span",{className:"text-sm font-bold",children:"Sistema Aut\xf3nomo"})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"group bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-red-500/30 rounded-2xl p-6 hover:border-red-500/60 hover:shadow-lg hover:shadow-red-500/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-red-400/70 text-xs font-bold uppercase tracking-widest mb-2",children:"\uD83D\uDC80 Hemorragia Hoy"}),(0,a.jsx)("div",{className:"text-4xl font-black text-red-400",children:c(e.hemorragiaHoy)})]}),(0,a.jsx)("div",{className:"text-3xl opacity-20",children:"\uD83D\uDCC9"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:"P\xe9rdida por cancelaciones/no-shows"}),(0,a.jsx)("div",{className:"mt-3 h-1 bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-red-500/80 transition-all",style:{width:`${Math.min(e.hemorragiaHoy/500*100,100)}%`}})})]}),(0,a.jsxs)("div",{className:"group bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-green-500/30 rounded-2xl p-6 hover:border-green-500/60 hover:shadow-lg hover:shadow-green-500/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-400/70 text-xs font-bold uppercase tracking-widest mb-2",children:"✨ Dinero Recuperado"}),(0,a.jsx)("div",{className:"text-4xl font-black text-green-400",children:c(e.dineroRecuperado)})]}),(0,a.jsx)("div",{className:"text-3xl opacity-20",children:"\uD83D\uDCC8"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:"Por citas confirmadas hoy"}),(0,a.jsx)("div",{className:"mt-3 h-1 bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-green-500/80 transition-all",style:{width:`${Math.min(e.dineroRecuperado/500*100,100)}%`}})})]}),(0,a.jsxs)("div",{className:"group bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-orange-500/30 rounded-2xl p-6 hover:border-orange-500/60 hover:shadow-lg hover:shadow-orange-500/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-orange-400/70 text-xs font-bold uppercase tracking-widest mb-2",children:"⚠️ Citas en Riesgo"}),(0,a.jsx)("div",{className:"text-4xl font-black text-orange-400",children:e.citasEnRiesgo})]}),(0,a.jsx)("div",{className:"text-3xl opacity-20",children:"\uD83C\uDFAF"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:"Pendientes confirmaci\xf3n (24h)"}),(0,a.jsx)("div",{className:"mt-3 h-1 bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-orange-500/80 transition-all",style:{width:`${Math.min(e.citasEnRiesgo/20*100,100)}%`}})})]}),(0,a.jsxs)("div",{className:"group bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-cyan-500/30 rounded-2xl p-6 hover:border-cyan-500/60 hover:shadow-lg hover:shadow-cyan-500/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-cyan-400/70 text-xs font-bold uppercase tracking-widest mb-2",children:"\uD83D\uDCCA Tasa No-Show"}),(0,a.jsxs)("div",{className:"text-4xl font-black text-cyan-400",children:[e.tasaNoShow,"%"]})]}),(0,a.jsx)("div",{className:"text-3xl opacity-20",children:"\uD83D\uDCC8"})]}),(0,a.jsx)("p",{className:"text-slate-400 text-xs",children:"Hist\xf3rico vs Benchmark (15-25%)"}),(0,a.jsx)("div",{className:"mt-3 h-1 bg-slate-700 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-cyan-500/80 transition-all",style:{width:`${Math.min(e.tasaNoShow/25*100,100)}%`}})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-cyan-950/50 to-slate-900/50 border-2 border-cyan-500/40 rounded-2xl p-6 hover:border-cyan-500/80 hover:shadow-2xl hover:shadow-cyan-500/30 transition-all duration-300 relative overflow-hidden group",children:[(0,a.jsx)("div",{className:"absolute -top-20 -right-20 w-40 h-40 bg-cyan-500/20 rounded-full blur-3xl group-hover:bg-cyan-500/40 transition-all duration-300"}),(0,a.jsxs)("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2 relative z-10",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC8E"}),"Ingresos Rescatados"]}),(0,a.jsxs)("div",{className:"space-y-4 relative z-10",children:[(0,a.jsxs)("div",{className:"p-4 bg-cyan-950/40 border border-cyan-500/30 rounded-lg hover:bg-cyan-950/60 transition-all",children:[(0,a.jsx)("p",{className:"text-cyan-300/80 text-xs font-bold uppercase tracking-wider mb-2",children:"Hoy"}),(0,a.jsx)("p",{className:"text-3xl font-black text-cyan-400",children:c(e.dineroRecuperado)})]}),(0,a.jsxs)("div",{className:"p-4 bg-orange-950/40 border border-orange-500/30 rounded-lg hover:bg-orange-950/60 transition-all",children:[(0,a.jsx)("p",{className:"text-orange-300/80 text-xs font-bold uppercase tracking-wider mb-2",children:"En Riesgo (24h)"}),(0,a.jsx)("p",{className:"text-3xl font-black text-orange-400",children:c(e.dineroEnRiesgo)})]}),(0,a.jsxs)("div",{className:"p-4 bg-red-950/40 border border-red-500/30 rounded-lg hover:bg-red-950/60 transition-all",children:[(0,a.jsx)("p",{className:"text-red-300/80 text-xs font-bold uppercase tracking-wider mb-2",children:"P\xe9rdida/Mes"}),(0,a.jsx)("p",{className:"text-3xl font-black text-red-400",children:c(e.hemorragiaMes)})]})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-red-500/30 rounded-2xl p-6 hover:border-red-500/60 transition-all",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCB0"}),"Impacto Financiero"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-400 text-xs uppercase tracking-widest mb-2",children:"P\xe9rdida Este Mes"}),(0,a.jsx)("p",{className:"text-3xl font-black text-red-400",children:c(e.hemorragiaMes)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-400 text-xs uppercase tracking-widest mb-2",children:"Dinero en Riesgo (Hoy)"}),(0,a.jsx)("p",{className:"text-3xl font-black text-orange-400",children:c(e.dineroEnRiesgo)})]}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-green-950/30 border border-green-500/30 rounded-lg",children:[(0,a.jsx)("p",{className:"text-green-400/80 text-xs font-bold uppercase tracking-widest mb-1",children:"Potencial de Recuperaci\xf3n"}),(0,a.jsx)("p",{className:"text-2xl font-black text-green-400",children:c(e.dineroRecuperado)})]})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-green-950/50 to-slate-900/50 border-2 border-green-500/40 rounded-2xl p-6 hover:border-green-500/80 hover:shadow-2xl hover:shadow-green-500/30 transition-all duration-300 relative overflow-hidden group",children:[(0,a.jsx)("div",{className:"absolute -bottom-20 -right-20 w-40 h-40 bg-green-500/20 rounded-full blur-3xl group-hover:bg-green-500/40 transition-all duration-300"}),(0,a.jsxs)("h3",{className:"text-lg font-bold text-white mb-6 flex items-center gap-2 relative z-10",children:[(0,a.jsx)("span",{className:"text-2xl",children:"⚡"}),"Sistema en Acci\xf3n"]}),(0,a.jsx)("div",{className:"space-y-3 relative z-10",children:e.recentRecoveries&&e.recentRecoveries.length>0?e.recentRecoveries.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-green-950/40 border border-green-500/40 rounded-lg hover:bg-green-950/60 hover:border-green-400/60 transition-all group/item",children:[(0,a.jsx)("div",{className:"text-green-400 mt-0.5 text-lg font-bold animate-pulse",children:"✓"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"text-green-200 text-sm font-semibold group-hover/item:text-green-100 transition-colors",children:["Recuperada: ",e.patientName]}),(0,a.jsxs)("p",{className:"text-slate-300 text-xs mt-1.5 font-mono",children:["\uD83D\uDCC5 ",e.appointmentDate]}),(0,a.jsxs)("p",{className:"text-green-400/70 text-xs mt-1 font-semibold",children:["⏰ ",function(e){let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/6e4),a=Math.floor(s/60);return s<1?"hace unos segundos":s<60?`hace ${s} min`:a<24?`hace ${a}h`:t.toLocaleDateString("es-ES")}(e.recoveredAt)]})]})]},e.id)):(0,a.jsxs)("div",{className:"p-6 text-center bg-slate-800/30 border border-slate-700/30 rounded-lg",children:[(0,a.jsx)("p",{className:"text-slate-300 text-sm font-semibold mb-1",children:"\uD83E\uDD16 Sistema activo"}),(0,a.jsx)("p",{className:"text-slate-500 text-xs",children:"Monitoreando citas en tiempo real..."})]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:[(0,a.jsxs)(n(),{href:"/prospects",className:"group p-6 bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-cyan-500/30 rounded-2xl hover:border-cyan-500/60 hover:shadow-lg hover:shadow-cyan-500/20 transition-all",children:[(0,a.jsx)("div",{className:"text-3xl mb-3",children:"\uD83D\uDD0D"}),(0,a.jsx)("h4",{className:"font-bold text-white mb-2",children:"Prospectos"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Gestiona tu pipeline de ventas"})]}),(0,a.jsxs)(n(),{href:"/pendientes",className:"group p-6 bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-orange-500/30 rounded-2xl hover:border-orange-500/60 hover:shadow-lg hover:shadow-orange-500/20 transition-all",children:[(0,a.jsx)("div",{className:"text-3xl mb-3",children:"⚡"}),(0,a.jsx)("h4",{className:"font-bold text-white mb-2",children:"Pendientes"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Decisiones y acciones urgentes"})]}),(0,a.jsxs)(n(),{href:"/dashboard/calculator",className:"group p-6 bg-gradient-to-br from-slate-900/50 to-slate-800/50 border border-violet-500/30 rounded-2xl hover:border-violet-500/60 hover:shadow-lg hover:shadow-violet-500/20 transition-all",children:[(0,a.jsx)("div",{className:"text-3xl mb-3",children:"\uD83D\uDCCA"}),(0,a.jsx)("h4",{className:"font-bold text-white mb-2",children:"Calculadora Premium"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"Ajusta par\xe1metros y simula escenarios"})]})]}),(0,a.jsxs)("div",{className:"p-8 bg-gradient-to-r from-cyan-950/30 via-blue-950/30 to-violet-950/30 border border-cyan-500/30 rounded-2xl text-center",children:[(0,a.jsx)("h4",{className:"text-2xl font-bold text-white mb-3",children:"\uD83E\uDD16 Sistema Aut\xf3nomo"}),(0,a.jsx)("p",{className:"text-slate-300 mb-6 max-w-2xl mx-auto",children:"El motor operacional est\xe1 escaneando citas en tiempo real. Las confirmaciones autom\xe1ticas se enviar\xe1n v\xeda WhatsApp seg\xfan se configuren. (En Phase 4)"}),(0,a.jsx)("button",{className:"px-8 py-3 bg-gradient-to-r from-cyan-500 via-blue-500 to-violet-500 text-white font-bold rounded-lg hover:shadow-xl hover:shadow-cyan-500/50 transition-all transform hover:scale-105",children:"Ver Prescripciones \uD83C\uDFAF"})]})]})})," "]})}},3606:(e,t,s)=>{"use strict";s.d(t,{o:()=>i});var a=s(8977);s(8063);var r=s(5546);async function n(e,t,s){let a=new Date;a.setHours(0,0,0,0);let r=new Date(a);r.setDate(r.getDate()-7);let n=new Date(a);n.setDate(n.getDate()-14);let{data:o}=await e.from("appointment_changes").select("id, appointment_id, created_at").eq("user_id",t).eq("is_system_recovery",!0).gte("created_at",r.toISOString()).lt("created_at",a.toISOString()),i=o?.length||0,l=Math.round(s/100*i*50),{data:d}=await e.from("appointment_changes").select("id").eq("user_id",t).eq("is_system_recovery",!0).gte("created_at",n.toISOString()).lt("created_at",r.toISOString()),c=d?.length||1,x=Math.round((i-c)/c*100);return{citasRecuperadas:i,dineroRecuperado:l,tasaRecuperacion:i>0?100:0,comparisonVsLastWeek:x,trendDirection:x>5?"up":x<-5?"down":"stable"}}async function o(e,t){let{data:s}=await e.from("appointment_changes").select(`
      id,
      created_at,
      appointment_id,
      appointments (
        appointment_date,
        start_time,
        patients (name)
      )
    `).eq("user_id",t).eq("is_system_recovery",!0).order("created_at",{ascending:!1}).limit(5);return(s||[]).map(e=>{let t=e.appointments,s=t?.patients,a=(s?.name||"Paciente").split(" "),r=a[0],n=a[1]?.charAt(0)||"",o=`${r} ${n}.`,i=new Date(t.appointment_date),l=new Date;l.setDate(l.getDate()+1),l.setHours(0,0,0,0);let d=i.getTime()===l.getTime()?`Ma\xf1ana ${t.start_time}`:i.toLocaleDateString("es-ES",{weekday:"long"})+" "+t.start_time;return{id:e.id,patientName:o,appointmentDate:d,recoveredAt:e.created_at}})}async function i(){try{let e=await (0,r.U)(),{data:{user:t},error:s}=await e.auth.getUser();if(s||!t)return{ok:!1,error:"No autenticado. Por favor inicia sesi\xf3n."};let a=new Date;a.setHours(0,0,0,0);let i=new Date(a);i.setDate(i.getDate()+1);let l=a.toISOString().split("T")[0],d=i.toISOString().split("T")[0],c=new Date;c.setDate(1),c.setHours(0,0,0,0);let{data:x,error:m}=await e.from("appointments").select("id, status, appointment_date").eq("user_id",t.id).eq("appointment_date",l);if(m)throw Error(`Failed to fetch today's appointments: ${m.message}`);let h=x?.length||0,p=x?.filter(e=>"confirmed"===e.status).length||0,u=x?.filter(e=>"cancelled"===e.status).length||0,g=x?.filter(e=>"pending"===e.status).length||0,{data:b,error:v}=await e.from("appointments").select("id, status, appointment_date").eq("user_id",t.id).eq("status","pending").gte("appointment_date",l).lt("appointment_date",d);if(v)throw Error(`Failed to fetch risk appointments: ${v.message}`);let f=b?.length||0,j=new Date(a);j.setDate(j.getDate()-1),j.toISOString().split("T")[0];let{data:N,error:w}=await e.from("appointments").select("id, status").eq("user_id",t.id).lt("appointment_date",l);if(w)throw Error(`Failed to fetch past appointments: ${w.message}`);let y=N?.length||1,D=N?.filter(e=>"no_show"===e.status).length||0,_=y>0?Math.round(D/y*100):0,k=50*(u+x?.filter(e=>"no_show"===e.status).length||0),{data:S,error:R}=await e.from("appointments").select("id, status, appointment_date").eq("user_id",t.id).gte("appointment_date",c.toISOString().split("T")[0]).lt("appointment_date",d);if(R)throw Error(`Failed to fetch month appointments: ${R.message}`);let P=50*(S?.filter(e=>"cancelled"===e.status||"no_show"===e.status).length||0),C=await n(e,t.id,_),E=await o(e,t.id);return{ok:!0,data:{citasHoy:h,citasPendientesConfirmacion:g,citasConfirmadas:p,citasCanceladas:u,citasEnRiesgo:f,tasaNoShow:_,hemorragiaHoy:k,hemorragiaMes:P,dineroRecuperado:50*p,dineroEnRiesgo:50*g,weeklyRecovery:C,recentRecoveries:E,systemActions:[]}}}catch(e){return console.error("Error calculating appointments metrics:",e),{ok:!1,error:e instanceof Error?e.message:"Failed to calculate metrics"}}}(0,s(6215).D)([i]),(0,a.A)(i,"00a10976f04beef674dbe7fa8a6b100c903bcdffa6",null)},7154:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i,dynamic:()=>o});var a=s(2740),r=s(3606),n=s(5122);let o="force-dynamic";async function i(){let e=await (0,r.o)();return e.ok?(0,a.jsx)(n.OperationalDashboard,{metrics:e.data}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-[#0a1628] to-slate-950 text-white p-6 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"max-w-md text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-red-400 mb-4",children:"Error"}),(0,a.jsx)("p",{className:"text-slate-300",children:e.error})]})})}},5122:(e,t,s)=>{"use strict";s.d(t,{OperationalDashboard:()=>a});let a=(0,s(6760).registerClientReference)(function(){throw Error("Attempted to call OperationalDashboard() from the server but OperationalDashboard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\USER\\Proyectos Personales Software\\v3-saas-factory\\saas-factory-setup\\saas-factory\\src\\features\\dashboard\\components\\OperationalDashboard.tsx","OperationalDashboard")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[638,403,531,181,969,73],()=>s(6290));module.exports=a})();